<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package Tutorial - Using LR Correction • hetAge</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Package Tutorial - Using LR Correction">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hetAge</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial-LR.html">Package Tutorial - Using LR Correction</a>
    </li>
    <li>
      <a href="../articles/tutorial-sva.html">Package Tutorial - Using SVA Correction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Package Tutorial - Using LR Correction</h1>
                        <h4 class="author">Melike Donertas</h4>
            
            <h4 class="date">2019-03-28</h4>
      
      
      <div class="hidden name"><code>tutorial-LR.Rmd</code></div>

    </div>

    
    
<div id="download-data-and-prepare-for-the-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#download-data-and-prepare-for-the-analysis" class="anchor"></a>Download data and prepare for the analysis</h1>
<p>Data is downloaded from GEO using getGEO function in GEOquery library. Expression matrix with probeset IDs, age of the samples and covarietes to be included in the analysis are extracted from geo object. Please note that this tutorial is just to demonstrate the functionality of this package and is not a proper gene expression analysis tutorial. Thus we skip many potential QC steps and probeset -&gt; gene ID mapping.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(GEOquery)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: Biobase</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: BiocGenerics</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Attaching package: 'BiocGenerics'</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; The following objects are masked from 'package:parallel':</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind,</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;     colMeans, colnames, colSums, dirname, do.call, duplicated,</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;     eval, evalq, Filter, Find, get, grep, grepl, intersect,</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;     is.unsorted, lapply, lengths, Map, mapply, match, mget, order,</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;     paste, pmax, pmax.int, pmin, pmin.int, Position, rank, rbind,</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;     Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;     table, tapply, union, unique, unsplit, which, which.max,</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt;     which.min</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; Welcome to Bioconductor</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;     Vignettes contain introductory material; view with</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt;     'citation("Biobase")', and for packages 'citation("pkgname")'.</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; Setting options('download.file.method.GEOquery'='auto')</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt; Setting options('GEOquery.inmemory.gpl'=FALSE)</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">geo &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/GEOquery/topics/getGEO">getGEO</a></span>(<span class="st">'GSE30272'</span>,<span class="dt">destdir =</span> <span class="st">'~/temp/'</span>)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; Found 1 file(s)</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt; GSE30272_series_matrix.txt.gz</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt; Using locally cached version: ~/temp//GSE30272_series_matrix.txt.gz</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt;   .default = col_double(),</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt;   ID_REF = col_character()</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt; See spec(...) for full column specifications.</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co">#&gt; Using locally cached version of GPL4611 found here:</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co">#&gt; ~/temp//GPL4611.soft</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44">pd &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/Biobase/topics/phenoData">pData</a></span>(geo)</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">expmat &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/Biobase/topics/exprs">exprs</a></span>(geo)</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">ages &lt;-<span class="st"> </span><span class="kw">setNames</span>(<span class="kw">as.numeric</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">age:ch1</span><span class="st">`</span>), pd<span class="op">$</span>geo_accession)</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">covs &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">array =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">array batch:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="dt">bbs =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">brain bank source:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="dt">sex =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">Sex:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="dt">race =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">race:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)))</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">ages &lt;-<span class="st"> </span>ages[ages <span class="op">&gt;=</span><span class="st"> </span><span class="dv">20</span>]</a>
<a class="sourceLine" id="cb1-52" data-line-number="52">expmat &lt;-<span class="st"> </span>expmat[, <span class="kw">names</span>(ages)]</a>
<a class="sourceLine" id="cb1-53" data-line-number="53">covs &lt;-<span class="st"> </span><span class="kw">lapply</span>(covs, <span class="cf">function</span>(x)x[<span class="kw">names</span>(ages)])</a></code></pre></div>
</div>
<div id="calculating-the-age-related-changes-in-expression-level-and-heterogeneity" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-the-age-related-changes-in-expression-level-and-heterogeneity" class="anchor"></a>Calculating the age-related changes in expression level and heterogeneity</h1>
<p>We can simply use <code>calc.het</code> function in our package to have all relevant results:</p>
<ul>
<li>Here we supply ages in years (‘age_in’ parameter) but we want the model to be constructed on the fourt root scale of age (‘age_to’ parameter).</li>
<li>We want to apply first linear regression and then Quantile Normalisation (‘batch_corr’ parameter) to correct for the confounding factors.</li>
<li>The list of covariates are provided to regerss out their effect</li>
<li>The age-related change in gene expression will be modelled using a linear model (‘modex’ parameter).</li>
<li>Data will not be log2 transformed (‘tr_log2’ parameter).</li>
<li>Features (probesets), will be scaled before the analysis (‘sc_features’ parameter).</li>
<li>We will use spearman correlation coefficient between absolute values of residuals from the model for age-related change in expression level and ages to assess age-related change in expression heterogeneity (‘het_change_met’ parameter).</li>
<li>All p-values calculated within this function will be corrected for multiple testing using ‘FDR’ (‘padj_met’ parameter).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(hetAge)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">resx &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.het.html">calc.het</a></span>(<span class="dt">exprmat =</span> expmat[<span class="kw">sample</span>(<span class="kw">rownames</span>(expmat),<span class="dv">1000</span>),], <span class="co"># expression matrix</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">age =</span> ages, <span class="co"># age vector</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">age_in =</span> <span class="st">'years'</span>,  <span class="co"># scale of the age vector</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">age_to =</span> <span class="st">'pw-0.25'</span>, <span class="co"># scale of ages to be used</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="dt">batch_corr =</span> <span class="st">'LR+QN'</span>,  <span class="co"># batch correction method</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="dt">modex =</span> <span class="st">'linear'</span>, <span class="co"># model for the change in expression level</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="dt">tr_log2 =</span> F, <span class="co"># log2 transform input matrix</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  <span class="dt">sc_features =</span> T, <span class="co"># scale genes / probesets</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  <span class="dt">covariates =</span> covs, <span class="co"># covariates</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  <span class="dt">het_change_met =</span> <span class="st">'spearman'</span>, <span class="co"># method to measure change in heterogeneity</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="dt">padj_met =</span> <span class="st">'fdr'</span>) <span class="co"># multiple test correction method</span></a></code></pre></div>
</div>
<div id="result-object" class="section level1">
<h1 class="hasAnchor">
<a href="#result-object" class="anchor"></a>Result object</h1>
<p>The resulting object is a list with several fields.</p>
<div id="the-list-of-sampels-used-in-the-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#the-list-of-sampels-used-in-the-analysis" class="anchor"></a>The list of sampels used in the analysis:</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>sampleID)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] "GSM750020" "GSM750021" "GSM750022" "GSM750023" "GSM750024" "GSM750025"</span></a></code></pre></div>
</div>
<div id="the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-" class="section level2">
<h2 class="hasAnchor">
<a href="#the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-" class="anchor"></a>The expression matrix inputted in the first place, only including the samples used in the analysis.</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">resx<span class="op">$</span>input_expr[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;                     GSM750020   GSM750021  GSM750022    GSM750023</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; HEEBO-097-HCA97C1   0.3647067  0.04735364 -0.1534902  0.270230140</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; HEEBO-019-HCC19A13 -0.5367653 -0.01656683 -0.0386164 -0.003260694</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; HEEBO-033-HCC33D15 -0.1659864 -0.28100090 -0.4913611 -0.418031537</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; HEEBO-011-HCC11J19  0.1239584  0.17697325  0.5602088  0.296938497</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; HEEBO-039-HCC39A6  -1.2963717  0.33492045 -0.6603374 -0.909165721</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;                      GSM750024</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.08428569</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; HEEBO-019-HCC19A13  0.10790286</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; HEEBO-033-HCC33D15 -0.19574565</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.06076193</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; HEEBO-039-HCC39A6  -0.61659478</span></a></code></pre></div>
</div>
<div id="the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis" class="anchor"></a>The ages in the original format, including only the samples used in the analysis</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>input_age)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; GSM750020 GSM750021 GSM750022 GSM750023 GSM750024 GSM750025 </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;  20.22192  20.78630  20.86301  20.94521  21.01918  21.47397</span></a></code></pre></div>
</div>
<div id="the-ages-after-re-formetted-into-desired-format" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ages-after-re-formetted-into-desired-format" class="anchor"></a>The ages after re-formetted into desired format</h2>
<p>Here we wanted the ages to be in fourth root scale.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>usedAge)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; GSM750020 GSM750021 GSM750022 GSM750023 GSM750024 GSM750025 </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;  9.268913  9.332920  9.341518  9.350705  9.358950  9.409170</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; ── Attaching packages ──────────────────────────────────────────────────── tidyverse 1.2.1 ──</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; ✔ ggplot2 3.0.0.9000     ✔ purrr   0.2.5     </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; ✔ tibble  1.4.2          ✔ dplyr   0.7.5     </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; ✔ tidyr   0.8.1          ✔ stringr 1.3.1     </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; ✔ readr   1.1.1          ✔ forcats 0.3.0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; ── Conflicts ─────────────────────────────────────────────────────── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; ✖ dplyr::combine()    masks Biobase::combine(), BiocGenerics::combine()</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; ✖ dplyr::exprs()      masks Biobase::exprs()</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; ✖ dplyr::filter()     masks stats::filter()</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; ✖ dplyr::lag()        masks stats::lag()</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; ✖ ggplot2::Position() masks BiocGenerics::Position(), base::Position()</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="kw">data.frame</span>(<span class="dt">age =</span> resx<span class="op">$</span>input_age, <span class="dt">age0.25 =</span> resx<span class="op">$</span>usedAge) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> age0<span class="fl">.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_smooth</span>( <span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="tutorial-LR_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="expression-matrix-after-correcting-for-confounding-factors" class="section level2">
<h2 class="hasAnchor">
<a href="#expression-matrix-after-correcting-for-confounding-factors" class="anchor"></a>Expression matrix after correcting for confounding factors</h2>
<p>These are the expression values for the probesets after accounting for the given covariates.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">resx<span class="op">$</span>LR_res<span class="op">$</span>correctedExp[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;                      GSM750020   GSM750021   GSM750022  GSM750023</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.10328449 -0.19814137 -0.21019395 -0.2334392</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; HEEBO-019-HCC19A13 -0.30573692 -0.08092002 -0.05159346  0.1443636</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; HEEBO-033-HCC33D15 -0.03312292 -0.13280212 -0.10645249 -0.1411303</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.06604475 -0.13083597 -0.02487649  0.1100179</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; HEEBO-039-HCC39A6  -0.30295488  0.86137046  0.16410328 -0.9808425</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;                       GSM750024</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; HEEBO-097-HCA97C1   0.008963819</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; HEEBO-019-HCC19A13  0.151267112</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; HEEBO-033-HCC33D15 -0.034165155</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.302378889</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; HEEBO-039-HCC39A6   0.302051897</span></a></code></pre></div>
</div>
<div id="covariate-coefficients-for-each-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-coefficients-for-each-feature" class="anchor"></a>Covariate coefficients for each feature</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>LR_res<span class="op">$</span>cov_coef)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;                    (Intercept) covarray.1 covarray.10 covarray.11</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; HEEBO-097-HCA97C1    0.4679912 -0.1342989 -0.16418057  0.06870043</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; HEEBO-019-HCC19A13  -0.2310284  0.2669027  0.24093221  0.09408347</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; HEEBO-033-HCC33D15  -0.1328635  0.1339161 -0.01532165 -0.14417910</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; HEEBO-011-HCC11J19   0.1900032  0.1167096 -0.03551719  0.09914870</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; HEEBO-039-HCC39A6   -0.9934168  0.6579343  0.48953034  0.49459804</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; HEEBO-030-HCC30C20   0.4932084 -0.1774681 -0.13621667  0.09749378</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;                    covarray.12  covarray.13 covarray.14 covarray.15</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.11742507  0.123875390 -0.09955602          NA</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; HEEBO-019-HCC19A13  0.04806977  0.054925168  0.09292481          NA</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; HEEBO-033-HCC33D15  0.21768523  0.005213636  0.33561597          NA</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.23389591 -0.004179063 -0.31171737          NA</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; HEEBO-039-HCC39A6   0.58771892  1.256061119  0.57349679          NA</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; HEEBO-030-HCC30C20 -0.52287245  0.535385576 -0.24919988          NA</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;                    covarray.16 covarray.17 covarray.18 covarray.19</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.47304341 -0.18405125 -0.39578845  -0.5098921</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; HEEBO-019-HCC19A13  0.15918522  0.14637988  0.04978704  -0.3481951</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; HEEBO-033-HCC33D15  0.12053440 -0.09948165  0.21250046   0.1702386</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; HEEBO-011-HCC11J19  0.05051729  0.02591260  0.21919366   0.0909304</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; HEEBO-039-HCC39A6   0.26573764  0.36140276 -0.01310135   0.1433876</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; HEEBO-030-HCC30C20 -0.10434088 -0.08434857 -0.18516057   0.4514934</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt;                    covarray.2  covarray.3  covarray.4  covarray.5</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.3681659 -0.32571763 -0.29250287 -0.11578139</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; HEEBO-019-HCC19A13  0.2983667  0.21546948  0.10392279  0.24895059</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt; HEEBO-033-HCC33D15  0.0230441 -0.04646963  0.07591812  0.10358545</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt; HEEBO-011-HCC11J19  0.1024904  0.38601261  0.13996996 -0.03085165</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt; HEEBO-039-HCC39A6   0.5126214  0.30623387  0.50288711  0.45855405</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt; HEEBO-030-HCC30C20 -0.1798595 -0.21257359 -0.53571112 -0.26399160</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt;                     covarray.6 covarray.7  covarray.8 covarray.9</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.26840276 -0.1340173 -0.16807225         NA</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; HEEBO-019-HCC19A13  0.32478348  0.2259417  0.15149651         NA</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; HEEBO-033-HCC33D15  0.04715653  0.1080823  0.12443436         NA</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; HEEBO-011-HCC11J19  0.27522649  0.1811002  0.05617305         NA</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; HEEBO-039-HCC39A6   0.29478104  0.2529130  0.42150664         NA</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; HEEBO-030-HCC30C20 -0.35118870 -0.1845569 -0.34412690         NA</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt;                    covbbs.BTB covbbs.NIMH    covsex.5    covsex.F covsex.M</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">#&gt; HEEBO-097-HCA97C1          NA          NA -0.11504368  0.08939468       NA</span></a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="co">#&gt; HEEBO-019-HCC19A13         NA          NA -0.68627415 -0.02972469       NA</span></a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="co">#&gt; HEEBO-033-HCC33D15         NA          NA -0.10700265  0.01836686       NA</span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="co">#&gt; HEEBO-011-HCC11J19         NA          NA  0.26497496 -0.10965958       NA</span></a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="co">#&gt; HEEBO-039-HCC39A6          NA          NA -0.53011661  0.14390902       NA</span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="co">#&gt; HEEBO-030-HCC30C20         NA          NA  0.08729262 -0.05657584       NA</span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="co">#&gt;                      covrace.AA  covrace.AS covrace.CAUC covrace.HISP</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.088197318 -0.03780008 -0.085569808           NA</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="co">#&gt; HEEBO-019-HCC19A13  0.028478951  0.03185028  0.028536005           NA</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="co">#&gt; HEEBO-033-HCC33D15 -0.149251424  0.02997994 -0.205575456           NA</span></a>
<a class="sourceLine" id="cb9-48" data-line-number="48"><span class="co">#&gt; HEEBO-011-HCC11J19  0.001096494 -0.25145434  0.009069488           NA</span></a>
<a class="sourceLine" id="cb9-49" data-line-number="49"><span class="co">#&gt; HEEBO-039-HCC39A6  -0.190967487 -0.18282430 -0.137257699           NA</span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50"><span class="co">#&gt; HEEBO-030-HCC30C20  0.027290240  0.10287553  0.130195284           NA</span></a></code></pre></div>
</div>
<div id="p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression" class="anchor"></a>P values for the covariate coefficients for each feature based on linear regression</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>LR_res<span class="op">$</span>cov_p)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;                     (Intercept) covarray.1 covarray.10 covarray.11</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; HEEBO-097-HCA97C1  0.0052348131 0.35249747  0.25621320  0.64142382</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; HEEBO-019-HCC19A13 0.1868636315 0.08181103  0.11587519  0.54643288</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; HEEBO-033-HCC33D15 0.2825322620 0.21555643  0.88700955  0.19242491</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; HEEBO-011-HCC11J19 0.3809565335 0.53772310  0.85116997  0.60859254</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; HEEBO-039-HCC39A6  0.0007674787 0.01005635  0.05411279  0.05695628</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; HEEBO-030-HCC30C20 0.0081510434 0.27042281  0.39724071  0.55312148</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;                    covarray.12  covarray.13 covarray.14 covarray.16</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; HEEBO-097-HCA97C1  0.491881106 3.989137e-01  0.61366815 0.002690282</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; HEEBO-019-HCC19A13 0.789957202 7.231735e-01  0.65574950 0.331556826</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; HEEBO-033-HCC33D15 0.089865385 9.620690e-01  0.02416906 0.298635764</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; HEEBO-011-HCC11J19 0.297460259 9.826749e-01  0.22952721 0.803628061</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; HEEBO-039-HCC39A6  0.050766949 2.826618e-06  0.09807045 0.327289248</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; HEEBO-030-HCC30C20 0.006739352 1.328057e-03  0.25763297 0.545403021</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;                    covarray.17 covarray.18 covarray.19 covarray.2</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; HEEBO-097-HCA97C1    0.2337504 0.009733966  0.02564432 0.02656628</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; HEEBO-019-HCC19A13   0.3697560 0.755255095  0.14709313 0.08780951</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; HEEBO-033-HCC33D15   0.3886502 0.061683856  0.31509495 0.85125500</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; HEEBO-011-HCC11J19   0.8980685 0.270026725  0.75942871 0.63485182</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; HEEBO-039-HCC39A6    0.1816461 0.960454030  0.71714775 0.07643999</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; HEEBO-030-HCC30C20   0.6234173 0.272346161  0.07504046 0.32690729</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;                    covarray.3  covarray.4 covarray.5 covarray.6 covarray.7</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; HEEBO-097-HCA97C1  0.02593861 0.075306265 0.43271902 0.06468153  0.3761548</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; HEEBO-019-HCC19A13 0.16089359 0.547757244 0.11192869 0.03483921  0.1591408</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; HEEBO-033-HCC33D15 0.66783757 0.534643126 0.34805391 0.66212006  0.3398555</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; HEEBO-011-HCC11J19 0.04392485 0.514338976 0.87328920 0.14780420  0.3622050</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; HEEBO-039-HCC39A6  0.22799443 0.080377482 0.07716112 0.24411316  0.3398048</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; HEEBO-030-HCC30C20 0.18909479 0.003810912 0.10971360 0.03044087  0.2743490</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt;                    covarray.8   covsex.5  covsex.F covrace.AA covrace.AS</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; HEEBO-097-HCA97C1  0.29941171 0.67742091 0.0886773  0.5390016  0.8475120</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; HEEBO-019-HCC19A13 0.37599391 0.02019224 0.5903835  0.8510581  0.8781855</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; HEEBO-033-HCC33D15 0.30409925 0.60485445 0.6380800  0.1656732  0.8383550</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; HEEBO-011-HCC11J19 0.79116345 0.46567579 0.1112917  0.9953532  0.3305933</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; HEEBO-039-HCC39A6  0.13770377 0.27414025 0.1168510  0.4471832  0.5951190</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; HEEBO-030-HCC30C20 0.05775621 0.77688071 0.3315705  0.8644211  0.6386390</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt;                    covrace.CAUC</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; HEEBO-097-HCA97C1     0.5631286</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; HEEBO-019-HCC19A13    0.8551872</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; HEEBO-033-HCC33D15    0.0648076</span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">#&gt; HEEBO-011-HCC11J19    0.9627308</span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; HEEBO-039-HCC39A6     0.5959252</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">#&gt; HEEBO-030-HCC30C20    0.4299738</span></a></code></pre></div>
</div>
<div id="the-expression-level-matrix-used-for-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#the-expression-level-matrix-used-for-modeling" class="anchor"></a>The expression level matrix used for modeling</h2>
<p>This is the matrix used to model age-related expression change - the reason it is different from corrected matrix is because we may further scale the expression level for the features (‘sc_features’ parameter.)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">resx<span class="op">$</span>usedMat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt;                     GSM750020  GSM750021  GSM750022  GSM750023   GSM750024</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.6572836 -0.7283496 -1.0541253 -0.4753906 -0.02227342</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; HEEBO-019-HCC19A13 -2.2607816 -0.2821983 -0.3244272  0.3542641  0.49595955</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; HEEBO-033-HCC33D15 -0.2968153 -0.7054619 -0.8153242 -0.4052971 -0.20414881</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.4574783 -0.5152641 -0.1975011  0.1874221 -0.83141947</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; HEEBO-039-HCC39A6  -1.3532642  2.0980463  0.7280825 -1.9469785  0.77143655</span></a></code></pre></div>
</div>
<div id="residuals-from-the-model-between-expression-level-and-age" class="section level2">
<h2 class="hasAnchor">
<a href="#residuals-from-the-model-between-expression-level-and-age" class="anchor"></a>Residuals from the model between expression level and age</h2>
<p>Absolute values of this matrix can be considered as the level of heterogeneity for each gene, each sample.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">resx<span class="op">$</span>residMat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt;                     GSM750020  GSM750021   GSM750022   GSM750023</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; HEEBO-097-HCA97C1  -0.4856662 -0.5624623 -0.88900787 -0.31109561</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; HEEBO-019-HCC19A13 -1.7224365  0.2381720  0.19352824  0.86963966</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; HEEBO-033-HCC33D15  0.2096184 -0.2159375 -0.32807149  0.07952866</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.2164968 -0.2823288  0.03435329  0.41812162</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; HEEBO-039-HCC39A6  -1.0795487  2.3626227  0.99143115 -1.68494155</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;                     GSM750024</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; HEEBO-097-HCA97C1   0.1412835</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; HEEBO-019-HCC19A13  1.0090197</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; HEEBO-033-HCC33D15  0.2784987</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; HEEBO-011-HCC11J19 -0.6017564</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; HEEBO-039-HCC39A6   1.0322962</span></a></code></pre></div>
</div>
<div id="data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity" class="section level2">
<h2 class="hasAnchor">
<a href="#data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity" class="anchor"></a>Data frame with the summaries of age-related changes in expression level and heterogeneity</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">colnames</span>(resx<span class="op">$</span>feature_result)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] "feature"                    "level_change"              </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; [3] "level_change.p"             "heterogeneity_change"      </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [5] "heterogeneity_change.p"     "level_change.p.adj"        </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; [7] "heterogeneity_change.p.adj"</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw">head</span>(resx<span class="op">$</span>feature_result) </a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; # A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;   feature   level_change level_change.p heterogeneity_ch… heterogeneity_c…</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; 1 HEEBO-09…       0.0895       0.302               0.0822            0.320</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; 2 HEEBO-01…       0.281        0.000995            0.0629            0.447</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; 3 HEEBO-03…       0.264        0.00200             0.108             0.191</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; 4 HEEBO-01…       0.126        0.147               0.0634            0.443</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; 5 HEEBO-03…       0.143        0.0988             -0.0125            0.880</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; 6 HEEBO-03…      -0.0967       0.265              -0.0947            0.252</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; # ... with 2 more variables: level_change.p.adj &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; #   heterogeneity_change.p.adj &lt;dbl&gt;</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#download-data-and-prepare-for-the-analysis">Download data and prepare for the analysis</a></li>
      <li><a href="#calculating-the-age-related-changes-in-expression-level-and-heterogeneity">Calculating the age-related changes in expression level and heterogeneity</a></li>
      <li>
<a href="#result-object">Result object</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-">The expression matrix inputted in the first place, only including the samples used in the analysis.</a></li>
      <li><a href="#the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis">The ages in the original format, including only the samples used in the analysis</a></li>
      <li><a href="#the-ages-after-re-formetted-into-desired-format">The ages after re-formetted into desired format</a></li>
      <li><a href="#expression-matrix-after-correcting-for-confounding-factors">Expression matrix after correcting for confounding factors</a></li>
      <li><a href="#covariate-coefficients-for-each-feature">Covariate coefficients for each feature</a></li>
      <li><a href="#p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression">P values for the covariate coefficients for each feature based on linear regression</a></li>
      <li><a href="#the-expression-level-matrix-used-for-modeling">The expression level matrix used for modeling</a></li>
      <li><a href="#residuals-from-the-model-between-expression-level-and-age">Residuals from the model between expression level and age</a></li>
      <li><a href="#data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity">Data frame with the summaries of age-related changes in expression level and heterogeneity</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Melike Donertas, Ulas Isildak, Mehmet Somel, Janet Thornton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
