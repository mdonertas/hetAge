<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package Tutorial - Using LR Correction • hetAge</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Package Tutorial - Using LR Correction">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hetAge</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial-LR.html">Package Tutorial - Using LR Correction</a>
    </li>
    <li>
      <a href="../articles/tutorial-sva.html">Package Tutorial - Using SVA Correction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Package Tutorial - Using LR Correction</h1>
                        <h4 class="author">Melike Donertas</h4>
            
            <h4 class="date">2018-08-27</h4>
      
      
      <div class="hidden name"><code>tutorial-LR.Rmd</code></div>

    </div>

    
    
<div id="download-data-and-prepare-for-the-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#download-data-and-prepare-for-the-analysis" class="anchor"></a>Download data and prepare for the analysis</h1>
<p>Data is downloaded from GEO using getGEO function in GEOquery library. Expression matrix with probeset IDs, age of the samples and covarietes to be included in the analysis are extracted from geo object. Please note that this tutorial is just to demonstrate the functionality of this package and is not a proper gene expression analysis tutorial. Thus we skip many potential QC steps and probeset -&gt; gene ID mapping.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(GEOquery)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: Biobase</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: BiocGenerics</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Attaching package: 'BiocGenerics'</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; The following objects are masked from 'package:parallel':</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind,</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;     colMeans, colnames, colSums, dirname, do.call, duplicated,</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;     eval, evalq, Filter, Find, get, grep, grepl, intersect,</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;     is.unsorted, lapply, lengths, Map, mapply, match, mget, order,</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;     paste, pmax, pmax.int, pmin, pmin.int, Position, rank, rbind,</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;     Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;     table, tapply, union, unique, unsplit, which, which.max,</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt;     which.min</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; Welcome to Bioconductor</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;     Vignettes contain introductory material; view with</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt;     'citation("Biobase")', and for packages 'citation("pkgname")'.</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; Setting options('download.file.method.GEOquery'='auto')</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt; Setting options('GEOquery.inmemory.gpl'=FALSE)</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">geo &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/GEOquery/topics/getGEO">getGEO</a></span>(<span class="st">'GSE30272'</span>,<span class="dt">destdir =</span> <span class="st">'~/temp/'</span>)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; Found 1 file(s)</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt; GSE30272_series_matrix.txt.gz</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt; Using locally cached version: ~/temp//GSE30272_series_matrix.txt.gz</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt;   .default = col_double(),</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt;   ID_REF = col_character()</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt; See spec(...) for full column specifications.</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co">#&gt; Using locally cached version of GPL4611 found here:</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co">#&gt; ~/temp//GPL4611.soft</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44">pd &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/Biobase/topics/phenoData">pData</a></span>(geo)</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">expmat &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/Biobase/topics/exprs">exprs</a></span>(geo)</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">ages &lt;-<span class="st"> </span><span class="kw">setNames</span>(<span class="kw">as.numeric</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">age:ch1</span><span class="st">`</span>), pd<span class="op">$</span>geo_accession)</a>
<a class="sourceLine" id="cb1-47" data-line-number="47">covs &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">array =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">array batch:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="dt">bbs =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">brain bank source:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="dt">sex =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">Sex:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="dt">race =</span> <span class="kw">as.factor</span>(<span class="kw">setNames</span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">race:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)))</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">ages &lt;-<span class="st"> </span>ages[ages <span class="op">&gt;=</span><span class="st"> </span><span class="dv">20</span>]</a>
<a class="sourceLine" id="cb1-52" data-line-number="52">expmat &lt;-<span class="st"> </span>expmat[, <span class="kw">names</span>(ages)]</a>
<a class="sourceLine" id="cb1-53" data-line-number="53">covs &lt;-<span class="st"> </span><span class="kw">lapply</span>(covs, <span class="cf">function</span>(x)x[<span class="kw">names</span>(ages)])</a></code></pre></div>
</div>
<div id="calculating-the-age-related-changes-in-expression-level-and-heterogeneity" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-the-age-related-changes-in-expression-level-and-heterogeneity" class="anchor"></a>Calculating the age-related changes in expression level and heterogeneity</h1>
<p>We can simply use <code>calc.het</code> function in our package to have all relevant results:</p>
<ul>
<li>Here we supply ages in years (‘age_in’ parameter) but we want the model to be constructed on the fourt root scale of age (‘age_to’ parameter).</li>
<li>We want to apply first linear regression and then Quantile Normalisation (‘batch_corr’ parameter) to correct for the confounding factors.</li>
<li>The list of covariates are provided to regerss out their effect</li>
<li>The age-related change in gene expression will be modelled using a linear model (‘modex’ parameter).</li>
<li>Data will not be log2 transformed (‘tr_log2’ parameter).</li>
<li>Features (probesets), will be scaled before the analysis (‘sc_features’ parameter).</li>
<li>We will use spearman correlation coefficient between absolute values of residuals from the model for age-related change in expression level and ages to assess age-related change in expression heterogeneity (‘het_change_met’ parameter).</li>
<li>All p-values calculated within this function will be corrected for multiple testing using ‘FDR’ (‘padj_met’ parameter).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(hetAge)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">resx &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.het.html">calc.het</a></span>(<span class="dt">exprmat =</span> expmat[<span class="kw">sample</span>(<span class="kw">rownames</span>(expmat),<span class="dv">1000</span>),], <span class="co"># expression matrix</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">age =</span> ages, <span class="co"># age vector</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">age_in =</span> <span class="st">'years'</span>,  <span class="co"># scale of the age vector</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">age_to =</span> <span class="st">'pw-0.25'</span>, <span class="co"># scale of ages to be used</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="dt">batch_corr =</span> <span class="st">'LR+QN'</span>,  <span class="co"># batch correction method</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="dt">modex =</span> <span class="st">'linear'</span>, <span class="co"># model for the change in expression level</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="dt">tr_log2 =</span> F, <span class="co"># log2 transform input matrix</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  <span class="dt">sc_features =</span> T, <span class="co"># scale genes / probesets</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  <span class="dt">covariates =</span> covs, <span class="co"># covariates</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  <span class="dt">het_change_met =</span> <span class="st">'spearman'</span>, <span class="co"># method to measure change in heterogeneity</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="dt">padj_met =</span> <span class="st">'fdr'</span>) <span class="co"># multiple test correction method</span></a></code></pre></div>
</div>
<div id="result-object" class="section level1">
<h1 class="hasAnchor">
<a href="#result-object" class="anchor"></a>Result object</h1>
<p>The resulting object is a list with several fields.</p>
<div id="the-list-of-sampels-used-in-the-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#the-list-of-sampels-used-in-the-analysis" class="anchor"></a>The list of sampels used in the analysis:</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>sampleID)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] "GSM750020" "GSM750021" "GSM750022" "GSM750023" "GSM750024" "GSM750025"</span></a></code></pre></div>
</div>
<div id="the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-" class="section level2">
<h2 class="hasAnchor">
<a href="#the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-" class="anchor"></a>The expression matrix inputted in the first place, only including the samples used in the analysis.</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">resx<span class="op">$</span>input_expr[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;                       GSM750020   GSM750021  GSM750022  GSM750023</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; HEEBO-028-HCC28B15  -0.19784457 -0.09546141 -0.1589613 -0.2359834</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.06493622 -0.37854038 -0.2417896 -0.3557261</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; HEEBO-107-HCE107I22 -1.48520950 -1.95610482 -2.1266665 -0.9711401</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; HEEBO-022-HCC22E4    0.89759515  0.14527780  0.6294776  0.3686566</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.52846702 -0.56551316 -0.4083924 -0.2422632</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;                        GSM750024</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; HEEBO-028-HCC28B15   0.005000254</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.223108608</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; HEEBO-107-HCE107I22 -1.478523457</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; HEEBO-022-HCC22E4    0.611548090</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.092808455</span></a></code></pre></div>
</div>
<div id="the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis" class="anchor"></a>The ages in the original format, including only the samples used in the analysis</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>input_age)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; GSM750020 GSM750021 GSM750022 GSM750023 GSM750024 GSM750025 </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;  20.22192  20.78630  20.86301  20.94521  21.01918  21.47397</span></a></code></pre></div>
</div>
<div id="the-ages-after-re-formetted-into-desired-format" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ages-after-re-formetted-into-desired-format" class="anchor"></a>The ages after re-formetted into desired format</h2>
<p>Here we wanted the ages to be in fourth root scale.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>usedAge)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; GSM750020 GSM750021 GSM750022 GSM750023 GSM750024 GSM750025 </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;  9.268913  9.332920  9.341518  9.350705  9.358950  9.409170</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; ── Attaching packages ──────────────────</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; ✔ ggplot2 2.2.1     ✔ purrr   0.2.5</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; ✔ tibble  1.4.2     ✔ dplyr   0.7.5</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; ✔ tidyr   0.8.1     ✔ stringr 1.3.1</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; ✔ readr   1.1.1     ✔ forcats 0.3.0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; ── Conflicts ── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; ✖ dplyr::combine()    masks Biobase::combine(), BiocGenerics::combine()</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; ✖ dplyr::exprs()      masks Biobase::exprs()</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; ✖ dplyr::filter()     masks stats::filter()</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; ✖ dplyr::lag()        masks stats::lag()</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; ✖ ggplot2::Position() masks BiocGenerics::Position(), base::Position()</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="kw">data.frame</span>(<span class="dt">age =</span> resx<span class="op">$</span>input_age, <span class="dt">age0.25 =</span> resx<span class="op">$</span>usedAge) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> age0<span class="fl">.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_smooth</span>( <span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="tutorial-LR_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="expression-matrix-after-correcting-for-confounding-factors" class="section level2">
<h2 class="hasAnchor">
<a href="#expression-matrix-after-correcting-for-confounding-factors" class="anchor"></a>Expression matrix after correcting for confounding factors</h2>
<p>These are the expression values for the probesets after accounting for the given covariates.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">resx<span class="op">$</span>LR_res<span class="op">$</span>correctedExp[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;                       GSM750020   GSM750021    GSM750022    GSM750023</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; HEEBO-028-HCC28B15   0.14374152 -0.08575944  0.093685091  0.069739561</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.09525359 -0.05652129 -0.008246693 -0.007962087</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; HEEBO-107-HCE107I22 -0.24226013 -0.28024400 -0.262323504 -0.144956126</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; HEEBO-022-HCC22E4    0.63936042 -0.14708593  0.487343901 -0.062234722</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.13483487 -0.31971370 -0.079435079  0.192685722</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;                       GSM750024</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; HEEBO-028-HCC28B15   0.40224614</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.01666995</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; HEEBO-107-HCE107I22  0.29373572</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; HEEBO-022-HCC22E4   -0.01630215</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; HEEBO-047-HCC47L23   0.20445321</span></a></code></pre></div>
</div>
<div id="covariate-coefficients-for-each-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-coefficients-for-each-feature" class="anchor"></a>Covariate coefficients for each feature</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>LR_res<span class="op">$</span>cov_coef)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;                     (Intercept)  covarray.1 covarray.10 covarray.11</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; HEEBO-028-HCC28B15  -0.34158608  0.25155700  0.02416937 -0.02761507</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; HEEBO-066-HCC66H21   0.03031737 -0.24627841 -0.28363933 -0.31598482</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; HEEBO-107-HCE107I22 -1.24294937 -0.65936021 -0.07445919  0.09313480</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; HEEBO-022-HCC22E4    0.25823473  0.03463733  0.15348972  0.21154725</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.39363215  0.06685272 -0.04656959  0.13628752</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; HEEBO-060-HCC60K24   0.22846849 -0.35232546 -0.26090316  0.02296620</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;                      covarray.12 covarray.13 covarray.14 covarray.15</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; HEEBO-028-HCC28B15  -0.009893142 -0.04446402 -0.17787945          NA</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.194463113 -0.27202330 -0.15429929          NA</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; HEEBO-107-HCE107I22 -1.304802487  0.19031663  0.31726625          NA</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; HEEBO-022-HCC22E4   -0.020549893  0.17316487  0.06500281          NA</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.209573393 -0.12229676 -0.14788766          NA</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; HEEBO-060-HCC60K24  -0.201058979 -0.22172737  0.04994266          NA</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;                     covarray.16 covarray.17 covarray.18 covarray.19</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; HEEBO-028-HCC28B15  -0.13598692  0.05956281 -0.35797083 -0.69302711</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.13069799 -0.40894653 -0.27202687 -0.14464434</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; HEEBO-107-HCE107I22 -0.75575856 -0.06351446  0.24691356  0.01561277</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; HEEBO-022-HCC22E4    0.37012383 -0.02469227 -0.02165697 -0.04725257</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; HEEBO-047-HCC47L23   0.01539051 -0.24882712 -0.58111425 -0.77455682</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; HEEBO-060-HCC60K24  -0.06902778 -0.36845799  0.18666500  0.17049381</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt;                      covarray.2 covarray.3  covarray.4  covarray.5</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; HEEBO-028-HCC28B15  -0.08606321  0.1114391  0.09253654  0.24006454</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.19521082 -0.1773961 -0.01688363 -0.13278662</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt; HEEBO-107-HCE107I22 -0.73084772 -0.8612123 -1.31639439 -0.01115028</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt; HEEBO-022-HCC22E4    0.05332263 -0.3689648 -0.29732622  0.02943189</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.25200676 -0.1113367  0.07433453  0.01426133</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt; HEEBO-060-HCC60K24  -0.21090752 -0.3272298 -0.26767794 -0.41981732</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt;                      covarray.6  covarray.7  covarray.8 covarray.9</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt; HEEBO-028-HCC28B15   0.17516507  0.05368101 -0.05138552         NA</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.16189479 -0.18467004 -0.23595876         NA</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; HEEBO-107-HCE107I22 -0.13416788 -0.48192857 -0.07132939         NA</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; HEEBO-022-HCC22E4    0.05832454 -0.05375891  0.07601450         NA</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; HEEBO-047-HCC47L23  -0.10605546  0.12153271 -0.20181382         NA</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; HEEBO-060-HCC60K24  -0.30397967 -0.27653991 -0.25606304         NA</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt;                     covbbs.BTB covbbs.NIMH    covsex.5    covsex.F</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">#&gt; HEEBO-028-HCC28B15          NA          NA -0.25432691  0.02889283</span></a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="co">#&gt; HEEBO-066-HCC66H21          NA          NA -0.08786056 -0.03438891</span></a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="co">#&gt; HEEBO-107-HCE107I22         NA          NA -0.42569984  0.01949769</span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="co">#&gt; HEEBO-022-HCC22E4           NA          NA  0.26446423  0.13607623</span></a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="co">#&gt; HEEBO-047-HCC47L23          NA          NA -0.46038766  0.01355101</span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="co">#&gt; HEEBO-060-HCC60K24          NA          NA -0.23795779 -0.03625412</span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="co">#&gt;                     covsex.M    covrace.AA  covrace.AS covrace.CAUC</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="co">#&gt; HEEBO-028-HCC28B15        NA  0.0803271194  0.11266801  -0.02249942</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="co">#&gt; HEEBO-066-HCC66H21        NA -0.1060580429 -0.29111178  -0.08646416</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="co">#&gt; HEEBO-107-HCE107I22       NA  0.2264487497  0.20788905   0.23981868</span></a>
<a class="sourceLine" id="cb9-48" data-line-number="48"><span class="co">#&gt; HEEBO-022-HCC22E4         NA -0.0005083162  0.19751637   0.25286371</span></a>
<a class="sourceLine" id="cb9-49" data-line-number="49"><span class="co">#&gt; HEEBO-047-HCC47L23        NA  0.0809799668  0.14263161   0.17601157</span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50"><span class="co">#&gt; HEEBO-060-HCC60K24        NA  0.0434567946 -0.05927548   0.03272654</span></a>
<a class="sourceLine" id="cb9-51" data-line-number="51"><span class="co">#&gt;                     covrace.HISP</span></a>
<a class="sourceLine" id="cb9-52" data-line-number="52"><span class="co">#&gt; HEEBO-028-HCC28B15            NA</span></a>
<a class="sourceLine" id="cb9-53" data-line-number="53"><span class="co">#&gt; HEEBO-066-HCC66H21            NA</span></a>
<a class="sourceLine" id="cb9-54" data-line-number="54"><span class="co">#&gt; HEEBO-107-HCE107I22           NA</span></a>
<a class="sourceLine" id="cb9-55" data-line-number="55"><span class="co">#&gt; HEEBO-022-HCC22E4             NA</span></a>
<a class="sourceLine" id="cb9-56" data-line-number="56"><span class="co">#&gt; HEEBO-047-HCC47L23            NA</span></a>
<a class="sourceLine" id="cb9-57" data-line-number="57"><span class="co">#&gt; HEEBO-060-HCC60K24            NA</span></a></code></pre></div>
</div>
<div id="p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression" class="anchor"></a>P values for the covariate coefficients for each feature based on linear regression</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">head</span>(resx<span class="op">$</span>LR_res<span class="op">$</span>cov_p)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;                      (Intercept)  covarray.1 covarray.10 covarray.11</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; HEEBO-028-HCC28B15  3.355441e-02 0.072554217 0.862185899 0.846175659</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; HEEBO-066-HCC66H21  7.983558e-01 0.018839805 0.007043029 0.003404461</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; HEEBO-107-HCE107I22 2.729293e-07 0.001258756 0.710073909 0.649275730</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; HEEBO-022-HCC22E4   3.246641e-01 0.879621963 0.502612412 0.366478563</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; HEEBO-047-HCC47L23  4.651609e-03 0.576432429 0.697161121 0.266331887</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; HEEBO-060-HCC60K24  6.875964e-02 0.001534919 0.017952962 0.836744610</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;                      covarray.12 covarray.13 covarray.14  covarray.16</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; HEEBO-028-HCC28B15  9.521188e-01  0.75347119   0.3506630 0.3635377262</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; HEEBO-066-HCC66H21  1.149462e-01  0.01089645   0.2774890 0.2416405461</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; HEEBO-107-HCE107I22 1.894148e-07  0.35070563   0.2475435 0.0005945515</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; HEEBO-022-HCC22E4   9.394899e-01  0.45703434   0.8352912 0.1333890917</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; HEEBO-047-HCC47L23  1.405191e-01  0.31564366   0.3664693 0.9045843181</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; HEEBO-060-HCC60K24  1.208868e-01  0.04716223   0.7374873 0.5554305234</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;                     covarray.17  covarray.18  covarray.19  covarray.2</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; HEEBO-028-HCC28B15  0.688993443 1.526092e-02 1.856304e-03 0.587738713</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; HEEBO-066-HCC66H21  0.000325366 1.338167e-02 3.746964e-01 0.100484587</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; HEEBO-107-HCE107I22 0.766636725 2.403304e-01 9.603505e-01 0.001691538</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; HEEBO-022-HCC22E4   0.919542932 9.279721e-01 8.952220e-01 0.837941502</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; HEEBO-047-HCC47L23  0.053383516 8.402116e-06 6.429599e-05 0.066365525</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; HEEBO-060-HCC60K24  0.001921188 1.038702e-01 3.196234e-01 0.091401388</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;                       covarray.3   covarray.4   covarray.5  covarray.6</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; HEEBO-028-HCC28B15  4.258638e-01 5.577210e-01 0.0933922348 0.209956138</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; HEEBO-066-HCC66H21  9.030956e-02 8.857703e-01 0.2117473259 0.120510177</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; HEEBO-107-HCE107I22 3.505835e-05 4.785193e-08 0.9565449821 0.503383193</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; HEEBO-022-HCC22E4   1.099536e-01 2.525526e-01 0.8998143416 0.798853486</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; HEEBO-047-HCC47L23  3.547472e-01 5.836366e-01 0.9071402552 0.376287442</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; HEEBO-060-HCC60K24  3.298346e-03 3.177157e-02 0.0002451186 0.006043644</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt;                     covarray.7 covarray.8   covsex.5  covsex.F covrace.AA</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; HEEBO-028-HCC28B15  0.71308364 0.74192179 0.34145616 0.5666635  0.5621335</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; HEEBO-066-HCC66H21  0.09128108 0.04404852 0.65868006 0.3604943  0.3049778</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; HEEBO-107-HCE107I22 0.02307356 0.75060653 0.26854900 0.7879453  0.2567722</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; HEEBO-022-HCC22E4   0.82263047 0.76684907 0.54670354 0.1021227  0.9982175</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; HEEBO-047-HCC47L23  0.33340599 0.13395581 0.04640125 0.7543722  0.4965614</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; HEEBO-060-HCC60K24  0.01674356 0.03769366 0.25600279 0.3589934  0.6886649</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt;                     covrace.AS covrace.CAUC</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; HEEBO-028-HCC28B15  0.55291710    0.8747755</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; HEEBO-066-HCC66H21  0.04113391    0.4168686</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; HEEBO-107-HCE107I22 0.44669709    0.2440868</span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">#&gt; HEEBO-022-HCC22E4   0.52669054    0.2821433</span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; HEEBO-047-HCC47L23  0.38239191    0.1530206</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">#&gt; HEEBO-060-HCC60K24  0.68998505    0.7697268</span></a></code></pre></div>
</div>
<div id="the-expression-level-matrix-used-for-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#the-expression-level-matrix-used-for-modeling" class="anchor"></a>The expression level matrix used for modeling</h2>
<p>This is the matrix used to model age-related expression change - the reason it is different from corrected matrix is because we may further scale the expression level for the features (‘sc_features’ parameter.)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">resx<span class="op">$</span>usedMat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt;                      GSM750020  GSM750021  GSM750022   GSM750023</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; HEEBO-028-HCC28B15   1.0091620 -0.2871123  0.5911650  0.29352207</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.9555347 -0.2572425 -0.1427567  0.09696569</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; HEEBO-107-HCE107I22 -1.0376738 -0.8270433 -1.0321936 -0.14971724</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; HEEBO-022-HCC22E4    3.3042969 -0.3330397  1.9308534 -0.03239003</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; HEEBO-047-HCC47L23  -1.1530169 -1.6169643 -0.6715564  0.56727248</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;                      GSM750024</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; HEEBO-028-HCC28B15   1.4006452</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.2210543</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; HEEBO-107-HCE107I22  0.6588546</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; HEEBO-022-HCC22E4   -0.0959017</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; HEEBO-047-HCC47L23   0.6736506</span></a></code></pre></div>
</div>
<div id="residuals-from-the-model-between-expression-level-and-age" class="section level2">
<h2 class="hasAnchor">
<a href="#residuals-from-the-model-between-expression-level-and-age" class="anchor"></a>Residuals from the model between expression level and age</h2>
<p>Absolute values of this matrix can be considered as the level of heterogeneity for each gene, each sample.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">resx<span class="op">$</span>residMat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt;                      GSM750020   GSM750021  GSM750022  GSM750023</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; HEEBO-028-HCC28B15   1.3954949  0.08632138  0.9628657  0.6633713</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; HEEBO-066-HCC66H21  -1.2084131 -0.50167761 -0.3860575 -0.1451232</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; HEEBO-107-HCE107I22 -0.6405742 -0.44320245 -0.6501340  0.2304394</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; HEEBO-022-HCC22E4    3.0327302 -0.59553912  1.6695722 -0.2923699</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; HEEBO-047-HCC47L23  -1.1400807 -1.60446002 -0.6591101  0.5796568</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;                      GSM750024</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; HEEBO-028-HCC28B15   1.7688328</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; HEEBO-066-HCC66H21  -0.4620556</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; HEEBO-107-HCE107I22  1.0373032</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; HEEBO-022-HCC22E4   -0.3547135</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; HEEBO-047-HCC47L23   0.6859793</span></a></code></pre></div>
</div>
<div id="data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity" class="section level2">
<h2 class="hasAnchor">
<a href="#data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity" class="anchor"></a>Data frame with the summaries of age-related changes in expression level and heterogeneity</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">colnames</span>(resx<span class="op">$</span>feature_result)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] "feature"                    "level_change"              </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; [3] "level_change.p"             "heterogeneity_change"      </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [5] "heterogeneity_change.p"     "level_change.p.adj"        </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; [7] "heterogeneity_change.p.adj"</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw">head</span>(resx<span class="op">$</span>feature_result) </a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; # A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;   feature   level_change level_change.p heterogeneity_ch… heterogeneity_c…</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; 1 HEEBO-02…      0.202           0.0192          -0.0778             0.347</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; 2 HEEBO-06…     -0.132           0.127            0.108              0.189</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; 3 HEEBO-10…      0.207           0.0161          -0.00474            0.954</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; 4 HEEBO-02…     -0.142           0.101           -0.0485             0.558</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; 5 HEEBO-04…      0.00675         0.938            0.00596            0.943</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; 6 HEEBO-06…      0.0909          0.294            0.0348             0.674</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; # ... with 2 more variables: level_change.p.adj &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; #   heterogeneity_change.p.adj &lt;dbl&gt;</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#download-data-and-prepare-for-the-analysis">Download data and prepare for the analysis</a></li>
      <li><a href="#calculating-the-age-related-changes-in-expression-level-and-heterogeneity">Calculating the age-related changes in expression level and heterogeneity</a></li>
      <li>
<a href="#result-object">Result object</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-">The expression matrix inputted in the first place, only including the samples used in the analysis.</a></li>
      <li><a href="#the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis">The ages in the original format, including only the samples used in the analysis</a></li>
      <li><a href="#the-ages-after-re-formetted-into-desired-format">The ages after re-formetted into desired format</a></li>
      <li><a href="#expression-matrix-after-correcting-for-confounding-factors">Expression matrix after correcting for confounding factors</a></li>
      <li><a href="#covariate-coefficients-for-each-feature">Covariate coefficients for each feature</a></li>
      <li><a href="#p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression">P values for the covariate coefficients for each feature based on linear regression</a></li>
      <li><a href="#the-expression-level-matrix-used-for-modeling">The expression level matrix used for modeling</a></li>
      <li><a href="#residuals-from-the-model-between-expression-level-and-age">Residuals from the model between expression level and age</a></li>
      <li><a href="#data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity">Data frame with the summaries of age-related changes in expression level and heterogeneity</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Melike Donertas, Ulas Isildak, Mehmet Somel, Janet Thornton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
