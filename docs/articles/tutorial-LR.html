<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package Tutorial - Using LR Correction • hetAge</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Package Tutorial - Using LR Correction">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hetAge</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial-LR.html">Package Tutorial - Using LR Correction</a>
    </li>
    <li>
      <a href="../articles/tutorial-sva.html">Package Tutorial - Using SVA Correction</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Package Tutorial - Using LR Correction</h1>
                        <h4 class="author">Melike Donertas</h4>
            
            <h4 class="date">2019-12-23</h4>
      
      
      <div class="hidden name"><code>tutorial-LR.Rmd</code></div>

    </div>

    
    
<div id="download-data-and-prepare-for-the-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#download-data-and-prepare-for-the-analysis" class="anchor"></a>Download data and prepare for the analysis</h1>
<p>Data is downloaded from GEO using getGEO function in GEOquery library. Expression matrix with probeset IDs, age of the samples and covarietes to be included in the analysis are extracted from geo object. Please note that this tutorial is just to demonstrate the functionality of this package and is not a proper gene expression analysis tutorial. Thus we skip many potential QC steps and probeset -&gt; gene ID mapping.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(GEOquery)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: Biobase</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: BiocGenerics</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Attaching package: 'BiocGenerics'</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; The following objects are masked from 'package:parallel':</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind,</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt;     colnames, dirname, do.call, duplicated, eval, evalq, Filter,</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt;     Find, get, grep, grepl, intersect, is.unsorted, lapply, Map,</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt;     mapply, match, mget, order, paste, pmax, pmax.int, pmin,</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt;     pmin.int, Position, rank, rbind, Reduce, rownames, sapply,</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt;     setdiff, sort, table, tapply, union, unique, unsplit, which,</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;     which.max, which.min</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; Welcome to Bioconductor</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt;     Vignettes contain introductory material; view with</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;     'citation("Biobase")', and for packages 'citation("pkgname")'.</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt; Setting options('download.file.method.GEOquery'='auto')</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; Setting options('GEOquery.inmemory.gpl'=FALSE)</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">geo &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/GEOquery/man/getGEO.html">getGEO</a></span>(<span class="st">'GSE30272'</span>,<span class="dt">destdir =</span> <span class="st">'~/temp/'</span>)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt; Found 1 file(s)</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; GSE30272_series_matrix.txt.gz</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt;   .default = col_double(),</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt;   ID_REF = col_character()</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt; See spec(...) for full column specifications.</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt; File stored at:</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt; ~/temp//GPL4611.soft</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42">pd &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span>(geo)</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">expmat &lt;-<span class="st"> </span>Biobase<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html">exprs</a></span>(geo)</a>
<a class="sourceLine" id="cb1-44" data-line-number="44">ages &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">age:ch1</span><span class="st">`</span>), pd<span class="op">$</span>geo_accession)</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">covs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">array =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">array batch:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-46" data-line-number="46"><span class="dt">bbs =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">brain bank source:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="dt">sex =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">Sex:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)),</a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="dt">race =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span>(pd<span class="op">$</span><span class="st">`</span><span class="dt">race:ch1</span><span class="st">`</span>, pd<span class="op">$</span>geo_accession)))</a>
<a class="sourceLine" id="cb1-49" data-line-number="49">ages &lt;-<span class="st"> </span>ages[ages <span class="op">&gt;=</span><span class="st"> </span><span class="dv">20</span>]</a>
<a class="sourceLine" id="cb1-50" data-line-number="50">expmat &lt;-<span class="st"> </span>expmat[, <span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(ages)]</a>
<a class="sourceLine" id="cb1-51" data-line-number="51">covs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(covs, <span class="cf">function</span>(x)x[<span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(ages)])</a></code></pre></div>
</div>
<div id="calculating-the-age-related-changes-in-expression-level-and-heterogeneity" class="section level1">
<h1 class="hasAnchor">
<a href="#calculating-the-age-related-changes-in-expression-level-and-heterogeneity" class="anchor"></a>Calculating the age-related changes in expression level and heterogeneity</h1>
<p>We can simply use <code>calc.het</code> function in our package to have all relevant results:</p>
<ul>
<li>Here we supply ages in years (‘age_in’ parameter) but we want the model to be constructed on the fourt root scale of age (‘age_to’ parameter).</li>
<li>We want to apply first linear regression and then Quantile Normalisation (‘batch_corr’ parameter) to correct for the confounding factors.</li>
<li>The list of covariates are provided to regerss out their effect</li>
<li>The age-related change in gene expression will be modelled using a linear model (‘modex’ parameter).</li>
<li>Data will not be log2 transformed (‘tr_log2’ parameter).</li>
<li>Features (probesets), will be scaled before the analysis (‘sc_features’ parameter).</li>
<li>We will use spearman correlation coefficient between absolute values of residuals from the model for age-related change in expression level and ages to assess age-related change in expression heterogeneity (‘het_change_met’ parameter).</li>
<li>All p-values calculated within this function will be corrected for multiple testing using ‘FDR’ (‘padj_met’ parameter).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(hetAge)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">resx &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.het.html">calc.het</a></span>(<span class="dt">exprmat =</span> expmat[<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(expmat),<span class="dv">1000</span>),], <span class="co"># expression matrix</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">age =</span> ages, <span class="co"># age vector</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">age_in =</span> <span class="st">'years'</span>,  <span class="co"># scale of the age vector</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">age_to =</span> <span class="st">'pw-0.25'</span>, <span class="co"># scale of ages to be used</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="dt">batch_corr =</span> <span class="st">'LR+QN'</span>,  <span class="co"># batch correction method</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="dt">modex =</span> <span class="st">'linear'</span>, <span class="co"># model for the change in expression level</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="dt">tr_log2 =</span> F, <span class="co"># log2 transform input matrix</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  <span class="dt">sc_features =</span> T, <span class="co"># scale genes / probesets</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  <span class="dt">covariates =</span> covs, <span class="co"># covariates</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  <span class="dt">het_change_met =</span> <span class="st">'spearman'</span>, <span class="co"># method to measure change in heterogeneity</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="dt">padj_met =</span> <span class="st">'fdr'</span>) <span class="co"># multiple test correction method</span></a></code></pre></div>
</div>
<div id="result-object" class="section level1">
<h1 class="hasAnchor">
<a href="#result-object" class="anchor"></a>Result object</h1>
<p>The resulting object is a list with several fields.</p>
<div id="the-list-of-samples-used-in-the-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#the-list-of-samples-used-in-the-analysis" class="anchor"></a>The list of samples used in the analysis:</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(resx<span class="op">$</span>sampleID)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; [1] "GSM750020" "GSM750021" "GSM750022" "GSM750023" "GSM750024" "GSM750025"</span></a></code></pre></div>
</div>
<div id="the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-" class="section level2">
<h2 class="hasAnchor">
<a href="#the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-" class="anchor"></a>The expression matrix inputted in the first place, only including the samples used in the analysis.</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">resx<span class="op">$</span>input_expr[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;                      GSM750020   GSM750021   GSM750022   GSM750023</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; HEEBO-050-HCC50H7   0.41841356 -0.10383482 -0.48497950 -0.96189505</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.22695232  0.10024554 -0.02790378  0.03458911</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.39782905 -0.06638279 -0.29374943 -0.16338653</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; HEEBO-107-HCE107N4  0.04845049  0.80899679  0.53429764  0.80920757</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; HEEBO-064-HCC64A7  -0.76351408 -1.11338623 -0.69825210 -0.72112046</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;                      GSM750024</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.94261579</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.21263432</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.07697231</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; HEEBO-107-HCE107N4  0.69107925</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; HEEBO-064-HCC64A7  -1.50584070</span></a></code></pre></div>
</div>
<div id="the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis" class="anchor"></a>The ages in the original format, including only the samples used in the analysis</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(resx<span class="op">$</span>input_age)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; GSM750020 GSM750021 GSM750022 GSM750023 GSM750024 GSM750025 </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;  20.22192  20.78630  20.86301  20.94521  21.01918  21.47397</span></a></code></pre></div>
</div>
<div id="the-ages-after-re-formetted-into-desired-format" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ages-after-re-formetted-into-desired-format" class="anchor"></a>The ages after re-formetted into desired format</h2>
<p>Here we wanted the ages to be in fourth root scale.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(resx<span class="op">$</span>usedAge)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; GSM750020 GSM750021 GSM750022 GSM750023 GSM750024 GSM750025 </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;  9.268913  9.332920  9.341518  9.350705  9.358950  9.409170</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; ── Attaching packages ────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; ✔ ggplot2 3.2.1     ✔ purrr   0.3.2</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; ✔ tibble  2.1.3     ✔ dplyr   0.8.3</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; ✔ tidyr   0.8.3     ✔ stringr 1.4.0</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.4.0</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; ── Conflicts ───────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; ✖ dplyr::combine()    masks Biobase::combine(), BiocGenerics::combine()</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; ✖ dplyr::filter()     masks stats::filter()</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; ✖ dplyr::lag()        masks stats::lag()</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; ✖ ggplot2::Position() masks BiocGenerics::Position(), base::Position()</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">age =</span> resx<span class="op">$</span>input_age, <span class="dt">age0.25 =</span> resx<span class="op">$</span>usedAge) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> age0<span class="fl">.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_smooth</span>( <span class="dt">method =</span> <span class="st">'loess'</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="tutorial-LR_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="expression-matrix-after-correcting-for-confounding-factors" class="section level2">
<h2 class="hasAnchor">
<a href="#expression-matrix-after-correcting-for-confounding-factors" class="anchor"></a>Expression matrix after correcting for confounding factors</h2>
<p>These are the expression values for the probesets after accounting for the given covariates.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">resx<span class="op">$</span>LR_res<span class="op">$</span>correctedExp[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;                      GSM750020   GSM750021   GSM750022   GSM750023</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; HEEBO-050-HCC50H7   0.31251736  0.32791282  0.05287975 -0.48493899</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.07652062  0.05886766 -0.07141268 -0.04746464</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.09406695 -0.07732671 -0.19459424  0.44152533</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; HEEBO-107-HCE107N4 -0.43387024  0.01353227 -0.40864540 -0.11575703</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; HEEBO-064-HCC64A7   0.26459226  0.06836189  0.12486510  0.45497072</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;                      GSM750024</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.43961052</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.27769857</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.11590229</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; HEEBO-107-HCE107N4  0.01591307</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; HEEBO-064-HCC64A7  -0.26462939</span></a></code></pre></div>
</div>
<div id="covariate-coefficients-for-each-feature" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-coefficients-for-each-feature" class="anchor"></a>Covariate coefficients for each feature</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(resx<span class="op">$</span>LR_res<span class="op">$</span>cov_coef)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt;                    (Intercept)  covarray.1 covarray.10 covarray.11</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; HEEBO-050-HCC50H7   0.10589620 -0.24726348  -0.3174158 -0.08495915</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.15043169  0.09359218   0.1015684  0.08050014</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.30376210  0.12727046   0.1464174 -0.09930445</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; HEEBO-107-HCE107N4  0.48232074  0.39801273   0.3181563  0.51002230</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; HEEBO-064-HCC64A7  -1.02810634 -0.27555253  -0.4687745 -0.63754497</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; HEEBO-058-HCC58J2  -0.09076304  0.01803283   0.1205988  0.12969898</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;                    covarray.12 covarray.13 covarray.14 covarray.15</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; HEEBO-050-HCC50H7    0.2323432 -0.29247191 -0.35976865          NA</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; HEEBO-014-HCC14A2    0.1373858  0.13426805  0.09892886          NA</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; HEEBO-013-HCC13I5   -0.1201259 -0.48858532 -0.02676348          NA</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; HEEBO-107-HCE107N4   0.2869419  0.52751281  0.34982456          NA</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; HEEBO-064-HCC64A7   -0.1761580 -0.26989559 -0.54188304          NA</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; HEEBO-058-HCC58J2    0.1335637  0.07732616 -0.11115959          NA</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt;                    covarray.16 covarray.17 covarray.18 covarray.19</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.31852112 -0.37069588 -0.24983418 -0.11140103</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; HEEBO-014-HCC14A2   0.11727855  0.11640972  0.20001967  0.40638862</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; HEEBO-013-HCC13I5   0.15525652 -0.24561020  0.13122850  0.40137192</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; HEEBO-107-HCE107N4  0.27771439  0.65461150  0.08569264 -0.15713710</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; HEEBO-064-HCC64A7  -0.33501572 -0.51393393 -0.68662754 -0.36931324</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt; HEEBO-058-HCC58J2  -0.04386163  0.02426425 -0.01190826  0.01677857</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt;                     covarray.2   covarray.3   covarray.4  covarray.5</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.17235664 -0.254362068 -0.181891339 -0.04547605</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">#&gt; HEEBO-014-HCC14A2   0.22461489  0.075677482  0.259907942  0.27121527</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">#&gt; HEEBO-013-HCC13I5   0.18366236  0.200564616 -0.006890764  0.01558079</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">#&gt; HEEBO-107-HCE107N4  0.39263692  0.592972379  0.394382999  0.26979473</span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">#&gt; HEEBO-064-HCC64A7  -0.11401385 -0.008997822 -0.015132478 -0.11494774</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">#&gt; HEEBO-058-HCC58J2  -0.09328478 -0.181333039  0.076809170 -0.13359528</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">#&gt;                     covarray.6  covarray.7  covarray.8 covarray.9</span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.21188847 -0.19745656 -0.20599945         NA</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">#&gt; HEEBO-014-HCC14A2   0.21503056  0.01367349  0.11876472         NA</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">#&gt; HEEBO-013-HCC13I5   0.05595373  0.05667079  0.10855671         NA</span></a>
<a class="sourceLine" id="cb9-34" data-line-number="34"><span class="co">#&gt; HEEBO-107-HCE107N4  0.22575512  0.42913925  0.29140606         NA</span></a>
<a class="sourceLine" id="cb9-35" data-line-number="35"><span class="co">#&gt; HEEBO-064-HCC64A7  -0.14555363 -0.24941995 -0.05574661         NA</span></a>
<a class="sourceLine" id="cb9-36" data-line-number="36"><span class="co">#&gt; HEEBO-058-HCC58J2  -0.27479140 -0.18112764 -0.06561190         NA</span></a>
<a class="sourceLine" id="cb9-37" data-line-number="37"><span class="co">#&gt;                    covbbs.BTB covbbs.NIMH     covsex.5      covsex.F</span></a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">#&gt; HEEBO-050-HCC50H7          NA          NA  0.467536343  0.1930790323</span></a>
<a class="sourceLine" id="cb9-39" data-line-number="39"><span class="co">#&gt; HEEBO-014-HCC14A2          NA          NA  0.065444748  0.0007401954</span></a>
<a class="sourceLine" id="cb9-40" data-line-number="40"><span class="co">#&gt; HEEBO-013-HCC13I5          NA          NA -0.006514384 -0.1282475134</span></a>
<a class="sourceLine" id="cb9-41" data-line-number="41"><span class="co">#&gt; HEEBO-107-HCE107N4         NA          NA  0.123629992  0.0104548384</span></a>
<a class="sourceLine" id="cb9-42" data-line-number="42"><span class="co">#&gt; HEEBO-064-HCC64A7          NA          NA  0.179705348 -0.0543069770</span></a>
<a class="sourceLine" id="cb9-43" data-line-number="43"><span class="co">#&gt; HEEBO-058-HCC58J2          NA          NA -0.139393533  0.0863485362</span></a>
<a class="sourceLine" id="cb9-44" data-line-number="44"><span class="co">#&gt;                    covsex.M  covrace.AA covrace.AS covrace.CAUC</span></a>
<a class="sourceLine" id="cb9-45" data-line-number="45"><span class="co">#&gt; HEEBO-050-HCC50H7        NA -0.29038036 -0.2571518  -0.38939339</span></a>
<a class="sourceLine" id="cb9-46" data-line-number="46"><span class="co">#&gt; HEEBO-014-HCC14A2        NA  0.09821739 -0.0130950   0.11826311</span></a>
<a class="sourceLine" id="cb9-47" data-line-number="47"><span class="co">#&gt; HEEBO-013-HCC13I5        NA  0.18743555  0.1814407   0.00404230</span></a>
<a class="sourceLine" id="cb9-48" data-line-number="48"><span class="co">#&gt; HEEBO-107-HCE107N4       NA -0.08486894  0.3293735  -0.13235007</span></a>
<a class="sourceLine" id="cb9-49" data-line-number="49"><span class="co">#&gt; HEEBO-064-HCC64A7        NA  0.12191074 -0.1499869   0.21398696</span></a>
<a class="sourceLine" id="cb9-50" data-line-number="50"><span class="co">#&gt; HEEBO-058-HCC58J2        NA  0.15533648  0.1422376   0.09493636</span></a>
<a class="sourceLine" id="cb9-51" data-line-number="51"><span class="co">#&gt;                    covrace.HISP</span></a>
<a class="sourceLine" id="cb9-52" data-line-number="52"><span class="co">#&gt; HEEBO-050-HCC50H7            NA</span></a>
<a class="sourceLine" id="cb9-53" data-line-number="53"><span class="co">#&gt; HEEBO-014-HCC14A2            NA</span></a>
<a class="sourceLine" id="cb9-54" data-line-number="54"><span class="co">#&gt; HEEBO-013-HCC13I5            NA</span></a>
<a class="sourceLine" id="cb9-55" data-line-number="55"><span class="co">#&gt; HEEBO-107-HCE107N4           NA</span></a>
<a class="sourceLine" id="cb9-56" data-line-number="56"><span class="co">#&gt; HEEBO-064-HCC64A7            NA</span></a>
<a class="sourceLine" id="cb9-57" data-line-number="57"><span class="co">#&gt; HEEBO-058-HCC58J2            NA</span></a></code></pre></div>
</div>
<div id="p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression" class="anchor"></a>P values for the covariate coefficients for each feature based on linear regression</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(resx<span class="op">$</span>LR_res<span class="op">$</span>cov_p)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt;                     (Intercept) covarray.1 covarray.10  covarray.11</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; HEEBO-050-HCC50H7  6.044190e-01 0.16772410 0.077362323 0.6418533379</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; HEEBO-014-HCC14A2  2.123830e-01 0.37394267 0.334853049 0.4543486905</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; HEEBO-013-HCC13I5  1.572207e-01 0.49637182 0.434143371 0.6036117980</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; HEEBO-107-HCE107N4 6.027030e-02 0.07584014 0.155014783 0.0266369534</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; HEEBO-064-HCC64A7  2.586563e-07 0.09720744 0.005234238 0.0002408845</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; HEEBO-058-HCC58J2  5.980491e-01 0.90455003 0.423268595 0.3996533372</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;                    covarray.12 covarray.13 covarray.14 covarray.16</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; HEEBO-050-HCC50H7    0.2727812  0.10905622  0.14217919  0.09837621</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; HEEBO-014-HCC14A2    0.2706074  0.21045524  0.49146257  0.29959172</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; HEEBO-013-HCC13I5    0.5874240  0.01117931  0.91658198  0.43963845</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt; HEEBO-107-HCE107N4   0.2776610  0.02123720  0.25188035  0.24677590</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; HEEBO-064-HCC64A7    0.3685183  0.11002923  0.01767788  0.06071122</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; HEEBO-058-HCC58J2    0.4535445  0.61328178  0.58886718  0.78586394</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;                    covarray.17  covarray.18 covarray.19 covarray.2</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; HEEBO-050-HCC50H7  0.053870274 0.1832010272  0.69094002 0.39776023</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt; HEEBO-014-HCC14A2  0.301122539 0.0710894511  0.01487045 0.06261956</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt; HEEBO-013-HCC13I5  0.220375327 0.5031512101  0.17270390 0.38942897</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; HEEBO-107-HCE107N4 0.006753940 0.7135432672  0.65311131 0.12383835</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; HEEBO-064-HCC64A7  0.004205155 0.0001182776  0.15588637 0.54523135</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt; HEEBO-058-HCC58J2  0.880013060 0.9397420060  0.94330012 0.58651580</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;                     covarray.3 covarray.4 covarray.5 covarray.6 covarray.7</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; HEEBO-050-HCC50H7  0.157657522 0.36948105 0.80325639 0.23696111 0.29263721</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt; HEEBO-014-HCC14A2  0.473784066 0.03063957 0.01266165 0.04257812 0.90125479</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt; HEEBO-013-HCC13I5  0.286406686 0.97405178 0.93501277 0.76487928 0.77251834</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt; HEEBO-107-HCE107N4 0.008937044 0.12005090 0.23741664 0.31218067 0.06801188</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; HEEBO-064-HCC64A7  0.956750850 0.93558964 0.49652449 0.37939863 0.15163875</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; HEEBO-058-HCC58J2  0.231148521 0.65233147 0.38549759 0.06965659 0.25190867</span></a>
<a class="sourceLine" id="cb10-30" data-line-number="30"><span class="co">#&gt;                    covarray.8  covsex.5    covsex.F covrace.AA covrace.AS</span></a>
<a class="sourceLine" id="cb10-31" data-line-number="31"><span class="co">#&gt; HEEBO-050-HCC50H7   0.3043340 0.1736161 0.003331931  0.1039510  0.2918009</span></a>
<a class="sourceLine" id="cb10-32" data-line-number="32"><span class="co">#&gt; HEEBO-014-HCC14A2   0.3143311 0.7453954 0.984479717  0.3484156  0.9271726</span></a>
<a class="sourceLine" id="cb10-33" data-line-number="33"><span class="co">#&gt; HEEBO-013-HCC13I5   0.6045628 0.9854982 0.059900865  0.3145151  0.4768843</span></a>
<a class="sourceLine" id="cb10-34" data-line-number="34"><span class="co">#&gt; HEEBO-107-HCE107N4  0.2444605 0.7722715 0.896865951  0.7018621  0.2792143</span></a>
<a class="sourceLine" id="cb10-35" data-line-number="35"><span class="co">#&gt; HEEBO-064-HCC64A7   0.7634354 0.5707692 0.364747837  0.4588068  0.5058298</span></a>
<a class="sourceLine" id="cb10-36" data-line-number="36"><span class="co">#&gt; HEEBO-058-HCC58J2   0.6971516 0.6289128 0.114538356  0.3001775  0.4881682</span></a>
<a class="sourceLine" id="cb10-37" data-line-number="37"><span class="co">#&gt;                    covrace.CAUC</span></a>
<a class="sourceLine" id="cb10-38" data-line-number="38"><span class="co">#&gt; HEEBO-050-HCC50H7    0.03508365</span></a>
<a class="sourceLine" id="cb10-39" data-line-number="39"><span class="co">#&gt; HEEBO-014-HCC14A2    0.27374203</span></a>
<a class="sourceLine" id="cb10-40" data-line-number="40"><span class="co">#&gt; HEEBO-013-HCC13I5    0.98317893</span></a>
<a class="sourceLine" id="cb10-41" data-line-number="41"><span class="co">#&gt; HEEBO-107-HCE107N4   0.56268604</span></a>
<a class="sourceLine" id="cb10-42" data-line-number="42"><span class="co">#&gt; HEEBO-064-HCC64A7    0.20813176</span></a>
<a class="sourceLine" id="cb10-43" data-line-number="43"><span class="co">#&gt; HEEBO-058-HCC58J2    0.53850700</span></a></code></pre></div>
</div>
<div id="the-expression-level-matrix-used-for-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#the-expression-level-matrix-used-for-modeling" class="anchor"></a>The expression level matrix used for modeling</h2>
<p>This is the matrix used to model age-related expression change - the reason it is different from corrected matrix is because we may further scale the expression level for the features (‘sc_features’ parameter.)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">resx<span class="op">$</span>usedMat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt;                     GSM750020  GSM750021  GSM750022   GSM750023</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; HEEBO-050-HCC50H7   1.5566029  1.0757655  0.1202068 -0.92153097</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.7648376  0.4023418 -0.6933833 -0.06451120</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.6489649 -0.3441871 -1.0104195  0.88862867</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; HEEBO-107-HCE107N4 -1.8876577  0.1249209 -1.5702193 -0.08204252</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; HEEBO-064-HCC64A7   1.5362155  0.3290369  0.5561910  0.87409073</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt;                      GSM750024</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.90810646</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; HEEBO-014-HCC14A2  -1.17674396</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.42238344</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; HEEBO-107-HCE107N4  0.04468823</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; HEEBO-064-HCC64A7  -0.62277955</span></a></code></pre></div>
</div>
<div id="residuals-from-the-model-between-expression-level-and-age" class="section level2">
<h2 class="hasAnchor">
<a href="#residuals-from-the-model-between-expression-level-and-age" class="anchor"></a>Residuals from the model between expression level and age</h2>
<p>Absolute values of this matrix can be considered as the level of heterogeneity for each gene, each sample.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">resx<span class="op">$</span>residMat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt;                     GSM750020   GSM750021   GSM750022  GSM750023</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; HEEBO-050-HCC50H7   1.4959220  1.01711076  0.06182425 -0.9796227</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; HEEBO-014-HCC14A2  -0.9873606  0.18724859 -0.90747830 -0.2775398</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.3070558 -0.01369397 -0.68146002  1.2159496</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; HEEBO-107-HCE107N4 -1.4862408  0.51293488 -1.18400597  0.3022471</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; HEEBO-064-HCC64A7   1.1086336 -0.08426851  0.14480361  0.4647524</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;                     GSM750024</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; HEEBO-050-HCC50H7  -0.9659372</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; HEEBO-014-HCC14A2  -1.3888155</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; HEEBO-013-HCC13I5  -0.0965331</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; HEEBO-107-HCE107N4  0.4272513</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; HEEBO-064-HCC64A7  -1.0302788</span></a></code></pre></div>
</div>
<div id="data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity" class="section level2">
<h2 class="hasAnchor">
<a href="#data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity" class="anchor"></a>Data frame with the summaries of age-related changes in expression level and heterogeneity</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(resx<span class="op">$</span>feature_result)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] "feature"                    "level_change"              </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; [3] "level_change.p"             "heterogeneity_change"      </span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [5] "heterogeneity_change.p"     "level_change.p.adj"        </span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt; [7] "heterogeneity_change.p.adj"</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(resx<span class="op">$</span>feature_result) </a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; # A tibble: 6 x 7</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt;   feature level_change level_change.p heterogeneity_c… heterogeneity_c…</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; 1 HEEBO-…      -0.0317        0.716           -0.0477             0.564</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; 2 HEEBO-…      -0.116         0.180            0.00281            0.973</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">#&gt; 3 HEEBO-…       0.178         0.0387          -0.0113             0.892</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="co">#&gt; 4 HEEBO-…       0.209         0.0149           0.0589             0.477</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">#&gt; 5 HEEBO-…      -0.223         0.00942          0.0435             0.599</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="co">#&gt; 6 HEEBO-…      -0.0185        0.831            0.0736             0.374</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="co">#&gt; # … with 2 more variables: level_change.p.adj &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; #   heterogeneity_change.p.adj &lt;dbl&gt;</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#download-data-and-prepare-for-the-analysis">Download data and prepare for the analysis</a></li>
      <li><a href="#calculating-the-age-related-changes-in-expression-level-and-heterogeneity">Calculating the age-related changes in expression level and heterogeneity</a></li>
      <li>
<a href="#result-object">Result object</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-expression-matrix-inputted-in-the-first-place-only-including-the-samples-used-in-the-analysis-">The expression matrix inputted in the first place, only including the samples used in the analysis.</a></li>
      <li><a href="#the-ages-in-the-original-format-including-only-the-samples-used-in-the-analysis">The ages in the original format, including only the samples used in the analysis</a></li>
      <li><a href="#the-ages-after-re-formetted-into-desired-format">The ages after re-formetted into desired format</a></li>
      <li><a href="#expression-matrix-after-correcting-for-confounding-factors">Expression matrix after correcting for confounding factors</a></li>
      <li><a href="#covariate-coefficients-for-each-feature">Covariate coefficients for each feature</a></li>
      <li><a href="#p-values-for-the-covariate-coefficients-for-each-feature-based-on-linear-regression">P values for the covariate coefficients for each feature based on linear regression</a></li>
      <li><a href="#the-expression-level-matrix-used-for-modeling">The expression level matrix used for modeling</a></li>
      <li><a href="#residuals-from-the-model-between-expression-level-and-age">Residuals from the model between expression level and age</a></li>
      <li><a href="#data-frame-with-the-summaries-of-age-related-changes-in-expression-level-and-heterogeneity">Data frame with the summaries of age-related changes in expression level and heterogeneity</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Melike Donertas, Ulas Isildak, Mehmet Somel, Janet Thornton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
